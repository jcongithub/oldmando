<!DOCTYPE html>
<html>
<head>
<script src="http://maps.googleapis.com/maps/api/js"></script>
<script src="https://ajax.googleapis.com/ajax/libs/jquery/1.12.4/jquery.min.js"></script>
<script>
var myCenter=new google.maps.LatLng(51.508742,-0.120850);
var map;

function initialize(){
    var mapProp = {
        center:myCenter,
        zoom:5,
        mapTypeId:google.maps.MapTypeId.ROADMAP
    };

    map=new google.maps.Map(document.getElementById("googleMap"),mapProp);

    //var marker=new google.maps.Marker({
    //    position:myCenter,
    //});

    //marker.setMap(map);
}

google.maps.event.addDomListener(window, 'load', initialize);

function showLocation(latlngs){
  console.info("Show location at ", latlngs);
  var bounds = new google.maps.LatLngBounds();
  for(var i = 0; i < latlngs.length; i++){
    var position = new google.maps.LatLng(latlngs[i].lat, latlngs[i].lng);
    var marker=new google.maps.Marker({
        position:position,
    });
    marker.setMap(map);
    bounds.extend(marker.getPosition());
  }
  map.fitBounds(bounds);

  //map.panTo(position);
}

function mapit(address){
  var latlng = geodecode(address, function(latlngs){
    showLocation(latlngs);
  }, function(err){
    console.info(err);
  });
}

function geodecode(address, success, fail){
  var url = "http://maps.googleapis.com/maps/api/geocode/json";
  var data = {address:address, sensor:false};
  $.get(url, data, "json").done(function(ret){
    if(ret.status == "OK"){
      console.info("Number of results:" + ret.results.length);
      var latlngs = [];
      for(var i = 0; i < ret.results.length; i++){
        latlngs.push(ret.results[i].geometry.location);
      }
      if(success)
        success(latlngs);
    }
    else{
      if(fail)
        fail("couldn't find the place:" + address)
    }
  });
  return {lat:51.508742, lng:-0.120850};
}

$(document).ready(function(){
  $("#id_mapit").click(function(){
    var address = $("#id_address").val();
    console.info("address:" + address);
    mapit(address);
  });
});

</script>
</head>

<body>
  <textarea id="id_address"></textarea>
  <input id="id_mapit" type="button" value="Map It"/>
  <div id="googleMap" style="width:500px;height:380px;"></div>

</body>
</html>
